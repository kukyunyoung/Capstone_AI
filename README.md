# 다중 감정 분류 및 추론 시스템 (NLP 기반)

## 개요

본 프로젝트는 BERT 기반의 NLP 모델을 활용하여 유튜브 댓글의 감정을 분석하는 시스템입니다. 감정 분류 모델을 학습하고, 이를 기반으로 유튜브 댓글의 긍정/부정/관련 없음 여부를 분류하여 결과를 제공합니다.
이를 통해 유튜브 댓글을 보다 효과적으로 분석하고 분석결과를 긍정, 부정, 관계없음으로 분류해 유튜브에서 제품리뷰(또는 광고)에 대한 소비자의 선택을 도와줄 수 있도록 제작되었습니다.

---

## 파일 설명

### 1. 다중감정분류\_nlp.py

- 감정 분석 모델을 학습하는 코드입니다.
- `KLUE/BERT` 모델을 활용하여 한국어 텍스트 감정 분류를 수행합니다.
- `TensorFlow` 및 `Transformers` 라이브러리를 사용합니다.
- 훈련 데이터 전처리, 토큰화, 모델 정의, 학습 및 저장 과정이 포함됩니다.

#### 주요 기능

1. 데이터 로드 및 전처리:
   - 유튜브 댓글 데이터를 로드 (`3952개 댓글.csv`)
   - '3952개 댓글.csv' 파일은 약 1000개의 댓글을 Data Augmentation 기법으로 증강한 데이터
   - 중복 제거, 결측값 처리, 특수 문자 제거
2. 데이터셋 분리:
   - `train_test_split`을 사용하여 학습 및 테스트 데이터셋으로 분리 (20% 테스트 데이터)
3. BERT 입력 데이터 변환:
   - 토큰화, 마스킹, 세그먼트 ID 처리
4. 모델 정의 및 학습:
   - `KLUE/BERT` 모델 활용
   - Softmax 활성화 함수를 사용한 다중 분류
   - 옵티마이저로 `Rectified Adam` 적용
   - 조기 종료(`EarlyStopping`) 및 체크포인트 저장(`ModelCheckpoint`)
5. 모델 저장:
   - 학습된 모델을 `best_model.pb` 파일로 저장

---

### 2. 캡스톤\_추론코드.py

- 학습된 감정 분석 모델을 사용하여 유튜브 댓글을 크롤링하고 감정을 예측하는 코드입니다.
- `Flask` 웹 애플리케이션을 통해 사용자가 유튜브 동영상 ID를 입력하면 해당 댓글을 분석하여 결과를 반환합니다.

#### 주요 기능

1. 유튜브 댓글 크롤링:
   - `Google API`를 활용하여 유튜브 영상 댓글을 가져옴
   - 최대 1000개의 댓글 수집 가능
   - 데이터를 `youtube_comments.xlsx`로 저장
2. 데이터 전처리:
   - 특수 문자 및 공백 제거
   - BERT 모델에 입력할 수 있도록 데이터 변환
3. 감정 예측:
   - 저장된 모델(`best_model.h5`)을 로드하여 감정 분류 수행
   - `argmax`를 활용해 최종 감정 레이블 (긍정/부정/관련 없음) 예측
4. 결과 분석:
   - 감정 분포 비율 계산 (긍정, 부정, 관련 없음)
   - 부정 및 긍정 댓글 샘플 제공
5. 웹 인터페이스 제공:
   - `Flask`를 사용하여 웹 애플리케이션 구축
   - 유튜브 영상 ID 입력 후 감정 분석 결과 출력

---

## 실행 방법

### 1. 감정 분석 모델 학습 (`다중감정분류_nlp.py` 실행)

```bash
python 다중감정분류_nlp.py
```

- 학습 완료 후 `best_model.pb` 파일이 생성됩니다.

### 2. 추론 및 웹 애플리케이션 실행 (`캡스톤_추론코드.py` 실행)

```bash
python 캡스톤_추론코드.py
```

- 웹 브라우저에서 `http://localhost:5000`으로 접속하여 유튜브 동영상 ID 입력 후 감정 분석 수행

---

## 참고사항

- 유튜브 댓글 크롤링을 위해 `Google API Key`가 필요합니다. (`get_comments` 함수 내 `DEVELOPER_KEY` 변경 필요)
- Colab 환경에서 실행합니다.

---

## 프로젝트 구조

```
├── 다중감정분류_nlp.py  # 감정 분석 모델 학습 코드
├── 캡스톤_추론코드.py  # 유튜브 댓글 감정 분석 및 웹 애플리케이션 코드
├── templates/
│   ├── index.html  # 웹 메인 페이지
│   ├── resultPage.html  # 감정 분석 결과 페이지
├── model/
│   ├── best_model.pb  # 학습된 모델 저장 파일
│   ├── best_model.h5  # 웹 애플리케이션에서 사용하는 모델 파일
├── data/
│   ├── 3952개 댓글.csv  # 감정 분석 모델 학습 데이터
│   ├── youtube_comments.xlsx  # 크롤링된 유튜브 댓글 데이터
```

---

## 제작자

- **프로젝트 팀명**: 2023 조선대학교 1학기 컴퓨터공학과 캡스톤디자인 3팀
- **이메일**: kyy991022@gmail.com


